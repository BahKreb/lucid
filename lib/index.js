const translations = {
    about: "about",
    accentHeight: "accent-height",
    accept: "accept",
    acceptCharset: "accept-charset",
    accessKey: "accesskey",
    accumulate: "accumulate",
    action: "action",
    additive: "additive",
    alignmentBaseline: "alignment-baseline",
    allowFullScreen: "allowfullscreen",
    allowReorder: "allowreorder",
    alphabetic: "alphabetic",
    alt: "alt",
    amplitude: "amplitude",
    arabicForm: "arabic-form",
    as: "as",
    ascent: "ascent",
    async: "async",
    attributeName: "attributename",
    attributeType: "attributetype",
    autoCapitalize: "autocapitalize",
    autoComplete: "autocomplete",
    autoCorrect: "autocorrect",
    autoFocus: "autofocus",
    autoPlay: "autoplay",
    autoReverse: "autoreverse",
    autoSave: "autosave",
    azimuth: "azimuth",
    baseFrequency: "basefrequency",
    baselineShift: "baseline-shift",
    baseProfile: "baseprofile",
    bbox: "bbox",
    begin: "begin",
    bias: "bias",
    by: "by",
    calcMode: "calcmode",
    capHeight: "cap-height",
    capture: "capture",
    cellPadding: "cellpadding",
    cellSpacing: "cellspacing",
    challenge: "challenge",
    charSet: "charset",
    checked: "checked",
    children: "children",
    cite: "cite",
    classID: "classid",
    className: "classname",
    clip: "clip",
    clipPath: "clip-path",
    clipPathUnits: "clippathunits",
    clipRule: "clip-rule",
    color: "color",
    colorInterpolation: "color-interpolation",
    colorInterpolationFilters: "color-interpolation-filters",
    colorProfile: "color-profile",
    colorRendering: "color-rendering",
    cols: "cols",
    colSpan: "colspan",
    content: "content",
    contentEditable: "contenteditable",
    contentScriptType: "contentscripttype",
    contentStyleType: "contentstyletype",
    contextMenu: "contextmenu",
    controls: "controls",
    controlsList: "controlslist",
    coords: "coords",
    crossOrigin: "crossorigin",
    cursor: "cursor",
    cx: "cx",
    cy: "cy",
    d: "d",
    dangerouslySetInnerHTML: "dangerouslysetinnerhtml",
    data: "data",
    datatype: "datatype",
    dateTime: "datetime",
    decelerate: "decelerate",
    default: "default",
    defaultChecked: "defaultchecked",
    defaultValue: "defaultvalue",
    defer: "defer",
    descent: "descent",
    diffuseConstant: "diffuseconstant",
    dir: "dir",
    direction: "direction",
    disabled: "disabled",
    disablePictureInPicture: "disablepictureinpicture",
    disableRemotePlayback: "disableremoteplayback",
    display: "display",
    divisor: "divisor",
    dominantBaseline: "dominant-baseline",
    download: "download",
    draggable: "draggable",
    dur: "dur",
    dx: "dx",
    dy: "dy",
    edgeMode: "edgemode",
    elevation: "elevation",
    enableBackground: "enable-background",
    encType: "enctype",
    end: "end",
    enterKeyHint: "enterkeyhint",
    exponent: "exponent",
    externalResourcesRequired: "externalresourcesrequired",
    fill: "fill",
    fillOpacity: "fill-opacity",
    fillRule: "fill-rule",
    filter: "filter",
    filterRes: "filterres",
    filterUnits: "filterunits",
    floodColor: "flood-color",
    floodOpacity: "flood-opacity",
    focusable: "focusable",
    fontFamily: "font-family",
    fontSize: "font-size",
    fontSizeAdjust: "font-size-adjust",
    fontStretch: "font-stretch",
    fontStyle: "font-style",
    fontVariant: "font-variant",
    fontWeight: "font-weight",
    form: "form",
    formAction: "formaction",
    format: "format",
    formEncType: "formenctype",
    formMethod: "formmethod",
    formNoValidate: "formnovalidate",
    formTarget: "formtarget",
    frameBorder: "frameborder",
    from: "from",
    fx: "fx",
    fy: "fy",
    g1: "g1",
    g2: "g2",
    glyphName: "glyph-name",
    glyphOrientationHorizontal: "glyph-orientation-horizontal",
    glyphOrientationVertical: "glyph-orientation-vertical",
    glyphRef: "glyphref",
    gradientTransform: "gradienttransform",
    gradientUnits: "gradientunits",
    hanging: "hanging",
    headers: "headers",
    height: "height",
    hidden: "hidden",
    high: "high",
    horizAdvX: "horiz-adv-x",
    horizOriginX: "horiz-origin-x",
    href: "href",
    hrefLang: "hreflang",
    htmlFor: "htmlfor",
    httpEquiv: "http-equiv",
    icon: "icon",
    id: "id",
    ideographic: "ideographic",
    imageRendering: "image-rendering",
    imageSizes: "imagesizes",
    imageSrcSet: "imagesrcset",
    in: "in",
    in2: "in2",
    inlist: "inlist",
    innerHTML: "innerhtml",
    inputMode: "inputmode",
    integrity: "integrity",
    intercept: "intercept",
    is: "is",
    itemID: "itemid",
    itemProp: "itemprop",
    itemRef: "itemref",
    itemScope: "itemscope",
    itemType: "itemtype",
    k: "k",
    k1: "k1",
    k2: "k2",
    k3: "k3",
    k4: "k4",
    kernelMatrix: "kernelmatrix",
    kernelUnitLength: "kernelunitlength",
    kerning: "kerning",
    keyParams: "keyparams",
    keyPoints: "keypoints",
    keySplines: "keysplines",
    keyTimes: "keytimes",
    keyType: "keytype",
    kind: "kind",
    label: "label",
    lang: "lang",
    lengthAdjust: "lengthadjust",
    letterSpacing: "letter-spacing",
    lightingColor: "lighting-color",
    limitingConeAngle: "limitingconeangle",
    list: "list",
    local: "local",
    loop: "loop",
    low: "low",
    manifest: "manifest",
    marginHeight: "marginheight",
    marginWidth: "marginwidth",
    markerEnd: "marker-end",
    markerHeight: "markerheight",
    markerMid: "marker-mid",
    markerStart: "marker-start",
    markerUnits: "markerunits",
    markerWidth: "markerwidth",
    mask: "mask",
    maskContentUnits: "maskcontentunits",
    maskUnits: "maskunits",
    mathematical: "mathematical",
    max: "max",
    maxLength: "maxlength",
    media: "media",
    mediaGroup: "mediagroup",
    method: "method",
    min: "min",
    minLength: "minlength",
    mode: "mode",
    multiple: "multiple",
    muted: "muted",
    name: "name",
    noModule: "nomodule",
    nonce: "nonce",
    noValidate: "novalidate",
    numOctaves: "numoctaves",
    offset: "offset",
    opacity: "opacity",
    open: "open",
    operator: "operator",
    optimum: "optimum",
    order: "order",
    orient: "orient",
    orientation: "orientation",
    origin: "origin",
    overflow: "overflow",
    overlinePosition: "overline-position",
    overlineThickness: "overline-thickness",
    paintOrder: "paint-order",
    panose1: "panose-1",
    pathLength: "pathlength",
    pattern: "pattern",
    patternContentUnits: "patterncontentunits",
    patternTransform: "patterntransform",
    patternUnits: "patternunits",
    placeholder: "placeholder",
    playsInline: "playsinline",
    pointerEvents: "pointer-events",
    points: "points",
    pointsAtX: "pointsatx",
    pointsAtY: "pointsaty",
    pointsAtZ: "pointsatz",
    poster: "poster",
    prefix: "prefix",
    preload: "preload",
    preserveAlpha: "preservealpha",
    preserveAspectRatio: "preserveaspectratio",
    primitiveUnits: "primitiveunits",
    profile: "profile",
    property: "property",
    r: "r",
    radioGroup: "radiogroup",
    radius: "radius",
    readOnly: "readonly",
    referrerPolicy: "referrerpolicy",
    refX: "refx",
    refY: "refy",
    rel: "rel",
    renderingIntent: "rendering-intent",
    repeatCount: "repeatcount",
    repeatDur: "repeatdur",
    required: "required",
    requiredExtensions: "requiredextensions",
    requiredFeatures: "requiredfeatures",
    resource: "resource",
    restart: "restart",
    result: "result",
    results: "results",
    reversed: "reversed",
    role: "role",
    rotate: "rotate",
    rows: "rows",
    rowSpan: "rowspan",
    rx: "rx",
    ry: "ry",
    sandbox: "sandbox",
    scale: "scale",
    scope: "scope",
    scoped: "scoped",
    scrolling: "scrolling",
    seamless: "seamless",
    security: "security",
    seed: "seed",
    selected: "selected",
    shape: "shape",
    shapeRendering: "shape-rendering",
    size: "size",
    sizes: "sizes",
    slope: "slope",
    spacing: "spacing",
    span: "span",
    specularConstant: "specularconstant",
    specularExponent: "specularexponent",
    speed: "speed",
    spellCheck: "spellcheck",
    spreadMethod: "spreadmethod",
    src: "src",
    srcDoc: "srcdoc",
    srcLang: "srclang",
    srcSet: "srcset",
    start: "start",
    startOffset: "startoffset",
    stdDeviation: "stddeviation",
    stemh: "stemh",
    stemv: "stemv",
    step: "step",
    stitchTiles: "stitchtiles",
    stopColor: "stop-color",
    stopOpacity: "stop-opacity",
    strikethroughPosition: "strikethrough-position",
    strikethroughThickness: "strikethrough-thickness",
    string: "string",
    stroke: "stroke",
    strokeDasharray: "stroke-dasharray",
    strokeDashoffset: "stroke-dashoffset",
    strokeLinecap: "stroke-linecap",
    strokeLinejoin: "stroke-linejoin",
    strokeMiterlimit: "stroke-miterlimit",
    strokeOpacity: "stroke-opacity",
    strokeWidth: "stroke-width",
    style: "style",
    summary: "summary",
    suppressContentEditableWarning: "suppresscontenteditablewarning",
    suppressHydrationWarning: "suppresshydrationwarning",
    surfaceScale: "surfacescale",
    systemLanguage: "systemlanguage",
    tabIndex: "tabindex",
    tableValues: "tablevalues",
    target: "target",
    targetX: "targetx",
    targetY: "targety",
    textAnchor: "text-anchor",
    textDecoration: "text-decoration",
    textLength: "textlength",
    textRendering: "text-rendering",
    title: "title",
    to: "to",
    transform: "transform",
    type: "type",
    typeof: "typeof",
    u1: "u1",
    u2: "u2",
    underlinePosition: "underline-position",
    underlineThickness: "underline-thickness",
    unicode: "unicode",
    unicodeBidi: "unicode-bidi",
    unicodeRange: "unicode-range",
    unitsPerEm: "units-per-em",
    unselectable: "unselectable",
    useMap: "usemap",
    vAlphabetic: "v-alphabetic",
    value: "value",
    values: "values",
    vectorEffect: "vector-effect",
    version: "version",
    vertAdvY: "vert-adv-y",
    vertOriginX: "vert-origin-x",
    vertOriginY: "vert-origin-y",
    vHanging: "v-hanging",
    vIdeographic: "v-ideographic",
    viewBox: "viewbox",
    viewTarget: "viewtarget",
    visibility: "visibility",
    vMathematical: "v-mathematical",
    vocab: "vocab",
    width: "width",
    widths: "widths",
    wmode: "wmode",
    wordSpacing: "word-spacing",
    wrap: "wrap",
    writingMode: "writing-mode",
    x: "x",
    x1: "x1",
    x2: "x2",
    xChannelSelector: "xchannelselector",
    xHeight: "x-height",
    xlinkActuate: "xlink:actuate",
    xlinkArcrole: "xlink:arcrole",
    xlinkHref: "xlink:href",
    xlinkRole: "xlink:role",
    xlinkShow: "xlink:show",
    xlinkTitle: "xlink:title",
    xlinkType: "xlink:type",
    xmlBase: "xml:base",
    xmlLang: "xml:lang",
    xmlns: "xmlns",
    xmlnsXlink: "xmlns:xlink",
    xmlSpace: "xmlspace",
    y: "y",
    y1: "y1",
    y2: "y2",
    yChannelSelector: "ychannelselector",
    z: "z",
    zoomAndPan: "zoomandpan"
};
function translate(key) {
    const translated = translations[key];
    if (translated)
        return translated;
    return key.toLowerCase();
}

class Lucid {
    local(value, container, cb) {
        if (container.state)
            return container.state;
        const proxy = new Proxy(value, {
            set: (t, p, v) => {
                t[p] = v;
                if (p !== "length")
                    cb();
                return true;
            }
        });
        container.state = proxy;
        return proxy;
    }
    createElement(tag, attrs, ...children) {
        return { tag, attrs, children };
    }
    render(dom, element) {
        if (typeof element.tag === "function") {
            const component = {
                attrs: element.attrs,
                update: () => {
                    if (typeof element.tag === "function")
                        this._update(component.__dom, element.tag(component));
                },
                __dom: undefined
            };
            this._render(dom, element.tag(component), component);
        }
    }
    _render(dom, element, component) {
        const elem = document.createElement(element.tag);
        if (component)
            component.__dom = elem;
        for (const key in element.attrs) {
            if (key.startsWith("on")) {
                elem.addEventListener(key.substring(2).toLocaleLowerCase(), (ev) => element.attrs[key](ev));
            }
            else {
                elem.setAttribute(translate(key), element.attrs[key]);
            }
        }
        for (let i = 0; i < element.children.length; ++i) {
            if (typeof element.children[i].tag === "function")
                this.render(elem, element.children[i]);
            else if (typeof element.children[i] === "object")
                this._render(elem, element.children[i], undefined);
            else
                elem.appendChild(document.createTextNode(element.children[i]));
        }
        dom.appendChild(elem);
    }
    _update(dom, element) {
        if (dom.tagName.toLowerCase() !== element.tag) {
            // TODO: Diff
            console.log("TODO: Diff");
        }
        // TODO: Property diff
        for (let i = 0; i < element.children.length || i < dom.childNodes.length; ++i) {
            // Remove the excess amount of children
            if (!element.children[i]) {
                dom.removeChild(dom.childNodes[i--]);
                continue;
            }
            if (typeof element.children[i] === "object") {
                this._update(dom.childNodes[i], element.children[i]);
            }
            else if (typeof element.children[i] === "function") {
                console.log("TODO: Handle element children re-render");
            }
            else {
                // DOM type is an element but the element child is a text node
                if (dom.childNodes[i].nodeType === document.ELEMENT_NODE) {
                    dom.removeChild(dom.childNodes[i]);
                    if (dom.childNodes.length > 1 && dom.childNodes[i])
                        dom.insertBefore(document.createTextNode(element.children[i]), dom.childNodes[i]);
                    else
                        dom.appendChild(document.createTextNode(element.children[i]));
                    i--;
                }
                else if (dom.childNodes[i].nodeValue !== element.children[i]) {
                    dom.childNodes[i].nodeValue = element.children[i];
                }
            }
        }
    }
}
const lucid = new Lucid();

export { lucid };
//# sourceMappingURL=index.js.map
